{"ast":null,"code":"import axios from\"axios\";import*as actionTypes from\"./actionTypes\";export var authStart=function authStart(){return{type:actionTypes.AUTH_START};};export var authSuccess=function authSuccess(user){return{type:actionTypes.AUTH_SUCCESS,user:user};};export var authFail=function authFail(error){return{type:actionTypes.AUTH_FAIL,error:error};};export var logout=function logout(){localStorage.removeItem(\"user\");return{type:actionTypes.AUTH_LOGOUT};};export var checkAuthTimeout=function checkAuthTimeout(expirationTime){return function(dispatch){setTimeout(function(){dispatch(logout());},expirationTime*1000);};};export var authLogin=function authLogin(username,password){return function(dispatch){dispatch(authStart());axios.post(\"http://127.0.0.1:8000/rest-auth/login/\",{username:username,password:password}).then(function(res){var user={token:res.data.key,username:username,userId:res.data.user,is_student:res.data.user_type.is_student,is_teacher:res.data.user_type.is_teacher,expirationDate:new Date(new Date().getTime()+3600*1000)};localStorage.setItem(\"user\",JSON.stringify(user));dispatch(authSuccess(user));dispatch(checkAuthTimeout(3600));}).catch(function(err){dispatch(authFail(err));});};};export var authSignup=function authSignup(username,email,password1,password2,is_student){return function(dispatch){dispatch(authStart());var user={username:username,email:email,password1:password1,password2:password2,is_student:is_student,is_teacher:!is_student};axios.post(\"http://127.0.0.1:8000/rest-auth/registration/\",user).then(function(res){var user={token:res.data.key,username:username,userId:res.data.user,is_student:is_student,is_teacher:!is_student,expirationDate:new Date(new Date().getTime()+3600*1000)};localStorage.setItem(\"user\",JSON.stringify(user));dispatch(authSuccess(user));dispatch(checkAuthTimeout(3600));}).catch(function(err){dispatch(authFail(err));});};};export var authCheckState=function authCheckState(){return function(dispatch){var user=JSON.parse(localStorage.getItem(\"user\"));if(user===undefined||user===null){dispatch(logout());}else{var expirationDate=new Date(user.expirationDate);if(expirationDate<=new Date()){dispatch(logout());}else{dispatch(authSuccess(user));dispatch(checkAuthTimeout((expirationDate.getTime()-new Date().getTime())/1000));}}};};","map":{"version":3,"sources":["H:/teach-me-django-master/src/store/actions/auth.js"],"names":["axios","actionTypes","authStart","type","AUTH_START","authSuccess","user","AUTH_SUCCESS","authFail","error","AUTH_FAIL","logout","localStorage","removeItem","AUTH_LOGOUT","checkAuthTimeout","expirationTime","dispatch","setTimeout","authLogin","username","password","post","then","res","token","data","key","userId","is_student","user_type","is_teacher","expirationDate","Date","getTime","setItem","JSON","stringify","catch","err","authSignup","email","password1","password2","authCheckState","parse","getItem","undefined"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport * as actionTypes from \"./actionTypes\";\n\nexport const authStart = () => {\n  return {\n    type: actionTypes.AUTH_START\n  };\n};\n\nexport const authSuccess = user => {\n  return {\n    type: actionTypes.AUTH_SUCCESS,\n    user\n  };\n};\n\nexport const authFail = error => {\n  return {\n    type: actionTypes.AUTH_FAIL,\n    error: error\n  };\n};\n\nexport const logout = () => {\n  localStorage.removeItem(\"user\");\n  return {\n    type: actionTypes.AUTH_LOGOUT\n  };\n};\n\nexport const checkAuthTimeout = expirationTime => {\n  return dispatch => {\n    setTimeout(() => {\n      dispatch(logout());\n    }, expirationTime * 1000);\n  };\n};\n\nexport const authLogin = (username, password) => {\n  return dispatch => {\n    dispatch(authStart());\n    axios\n      .post(\"http://127.0.0.1:8000/rest-auth/login/\", {\n        username: username,\n        password: password\n      })\n      .then(res => {\n        const user = {\n          token: res.data.key,\n          username,\n          userId: res.data.user,\n          is_student: res.data.user_type.is_student,\n          is_teacher: res.data.user_type.is_teacher,\n          expirationDate: new Date(new Date().getTime() + 3600 * 1000)\n        };\n        localStorage.setItem(\"user\", JSON.stringify(user));\n        dispatch(authSuccess(user));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authSignup = (\n  username,\n  email,\n  password1,\n  password2,\n  is_student\n) => {\n  return dispatch => {\n    dispatch(authStart());\n    const user = {\n      username,\n      email,\n      password1,\n      password2,\n      is_student,\n      is_teacher: !is_student\n    };\n    axios\n      .post(\"http://127.0.0.1:8000/rest-auth/registration/\", user)\n      .then(res => {\n        const user = {\n          token: res.data.key,\n          username,\n          userId: res.data.user,\n          is_student,\n          is_teacher: !is_student,\n          expirationDate: new Date(new Date().getTime() + 3600 * 1000)\n        };\n        localStorage.setItem(\"user\", JSON.stringify(user));\n        dispatch(authSuccess(user));\n        dispatch(checkAuthTimeout(3600));\n      })\n      .catch(err => {\n        dispatch(authFail(err));\n      });\n  };\n};\n\nexport const authCheckState = () => {\n  return dispatch => {\n    const user = JSON.parse(localStorage.getItem(\"user\"));\n    if (user === undefined || user === null) {\n      dispatch(logout());\n    } else {\n      const expirationDate = new Date(user.expirationDate);\n      if (expirationDate <= new Date()) {\n        dispatch(logout());\n      } else {\n        dispatch(authSuccess(user));\n        dispatch(\n          checkAuthTimeout(\n            (expirationDate.getTime() - new Date().getTime()) / 1000\n          )\n        );\n      }\n    }\n  };\n};\n"]},"metadata":{},"sourceType":"module"}